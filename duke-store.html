<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DUKE ‚Äî Premium Apparel</title>
<!-- ============================================================
     ADOBE DATA LAYER (ACDL) ‚Äî Initialisation
     Must be the very first script on the page so all subsequent
     pushes are queued even before Alloy/Launch loads.
     In production replace this with the Launch embed code.
     ============================================================ -->
<script>
  // Initialise the Adobe Client Data Layer array if not already present
  window.adobeDataLayer = window.adobeDataLayer || [];

  // Helper: push an event + state snapshot into the data layer
  window.adobeDataLayer.push = (function(orig) {
    return function(payload) {
      orig.call(window.adobeDataLayer, payload);
      // Mirror every push to the browser console so you can inspect
      // it in DevTools while practising
      console.groupCollapsed('%c[ACDL] ' + (payload.event || payload['@type'] || 'state-update'), 'color:#eb1000;font-weight:bold');
      console.log(JSON.parse(JSON.stringify(payload)));
      console.groupEnd();
    };
  }(Array.prototype.push));
</script>

<!-- ============================================================
     ADOBE WEB SDK (Alloy) ‚Äî Stub / Placeholder
     Replace the stub below with the real Alloy CDN snippet
     from your AEP Data Collection UI:

     <script src="https://cdn1.adoberesources.net/alloy/2.x.x/alloy.min.js"></script>

     Then configure with:
       alloy("configure", {
         datastreamId: "<YOUR_DATASTREAM_ID>",
         orgId:        "<YOUR_IMS_ORG_ID>@AdobeOrg",
         debugEnabled: true
       });

     The stub below intercepts every alloy() call and logs it so
     you can validate XDM payloads without a real AEP connection.
     ============================================================ -->
<script>
  // Alloy command queue stub ‚Äî mirrors the real Alloy bootstrap pattern
  !function(n, o) {
    o = n.alloy = n.alloy || function() {
      var q = arguments;
      return new Promise(function(resolve, reject) {
        // Log every call for practice/inspection
        console.groupCollapsed('%c[ALLOY] alloy("' + q[0] + '")', 'color:#1473e6;font-weight:bold');
        console.log('Command :', q[0]);
        if (q[1]) console.log('Payload :', JSON.parse(JSON.stringify(q[1])));
        console.groupEnd();
        resolve({ requestId: 'stub-' + Date.now() });
      });
    };
  }(window);

  // Configure Web SDK (stub ‚Äî swap these values with real ones)
  alloy("configure", {
    datastreamId: "YOUR_DATASTREAM_ID",          // ‚Üê replace
    orgId:        "YOUR_IMS_ORG@AdobeOrg",       // ‚Üê replace
    debugEnabled: true,
    clickCollectionEnabled: true,
    onBeforeEventSend: function(options) {
      // Last-chance hook to mutate the XDM before it leaves the browser
      console.log('%c[ALLOY] onBeforeEventSend XDM:', 'color:#1473e6', options.xdm);
    }
  });
</script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --ink: #0d0d0d;
  --paper: #f5f2ee;
  --cream: #ede9e3;
  --accent: #c8a96e;
  --accent-dark: #a8843e;
  --muted: #888077;
  --border: #d6d0c7;
  --white: #ffffff;
  --error: #c0392b;
  --success: #27ae60;
  --shadow: 0 4px 32px rgba(13,13,13,0.08);
  --shadow-lg: 0 16px 64px rgba(13,13,13,0.14);
}

*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{font-family:'DM Sans',sans-serif;background:var(--paper);color:var(--ink);min-height:100vh;overflow-x:hidden}
a{text-decoration:none;color:inherit}
img{max-width:100%;display:block}
button{cursor:pointer;font-family:'DM Sans',sans-serif}

/* UTILS */
.hidden{display:none!important}
.page{display:none;animation:fadeIn .4s ease}
.page.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideDown{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}

/* ==================== NAV ==================== */
nav{position:sticky;top:0;z-index:100;background:var(--paper);border-bottom:1px solid var(--border);backdrop-filter:blur(8px)}
.nav-inner{max-width:1400px;margin:0 auto;padding:0 40px;display:flex;align-items:center;justify-content:space-between;height:72px}
.nav-logo{font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:600;letter-spacing:.08em;cursor:pointer}
.nav-logo span{color:var(--accent)}
.nav-links{display:flex;gap:36px;list-style:none}
.nav-links a{font-size:13px;font-weight:400;letter-spacing:.08em;text-transform:uppercase;color:var(--muted);transition:color .2s;cursor:pointer}
.nav-links a:hover,.nav-links a.active{color:var(--ink)}
.nav-actions{display:flex;align-items:center;gap:20px}
.nav-icon{width:40px;height:40px;border:none;background:none;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background .2s;position:relative}
.nav-icon:hover{background:var(--cream)}
.nav-icon svg{width:20px;height:20px;stroke:var(--ink);fill:none;stroke-width:1.5}
.cart-badge{position:absolute;top:6px;right:6px;width:16px;height:16px;background:var(--accent);border-radius:50%;font-size:10px;font-weight:500;display:flex;align-items:center;justify-content:center;color:var(--white)}

/* ==================== HERO BANNER ==================== */
.hero{height:90vh;min-height:600px;background:var(--ink);position:relative;overflow:hidden;display:flex;align-items:center}
.hero-bg{position:absolute;inset:0;background:linear-gradient(135deg,#0d0d0d 0%,#1a1a1a 40%,#0f0f0f 100%)}
.hero-pattern{position:absolute;inset:0;opacity:.04;background-image:repeating-linear-gradient(0deg,transparent,transparent 60px,#fff 60px,#fff 61px),repeating-linear-gradient(90deg,transparent,transparent 60px,#fff 60px,#fff 61px)}
.hero-content{position:relative;max-width:1400px;margin:0 auto;padding:0 40px;width:100%}
.hero-tag{font-size:11px;letter-spacing:.2em;text-transform:uppercase;color:var(--accent);margin-bottom:24px}
.hero-title{font-family:'Cormorant Garamond',serif;font-size:clamp(60px,8vw,120px);font-weight:300;line-height:.95;color:var(--white);margin-bottom:32px}
.hero-title em{font-style:italic;color:var(--accent)}
.hero-subtitle{font-size:16px;font-weight:300;color:rgba(255,255,255,.5);max-width:420px;line-height:1.7;margin-bottom:48px}
.btn-primary{display:inline-flex;align-items:center;gap:10px;background:var(--accent);color:var(--white);padding:16px 36px;font-size:13px;letter-spacing:.1em;text-transform:uppercase;font-weight:500;border:none;transition:all .25s;border-radius:2px}
.btn-primary:hover{background:var(--accent-dark);transform:translateY(-1px)}
.btn-outline{display:inline-flex;align-items:center;gap:10px;background:transparent;color:var(--white);padding:15px 36px;font-size:13px;letter-spacing:.1em;text-transform:uppercase;font-weight:400;border:1px solid rgba(255,255,255,.3);transition:all .25s;border-radius:2px}
.btn-outline:hover{border-color:var(--white);background:rgba(255,255,255,.05)}
.hero-btns{display:flex;gap:16px;flex-wrap:wrap}
.hero-scroll{position:absolute;bottom:48px;right:40px;display:flex;flex-direction:column;align-items:center;gap:8px;color:rgba(255,255,255,.3);font-size:11px;letter-spacing:.15em;text-transform:uppercase}
.hero-scroll-line{width:1px;height:60px;background:linear-gradient(to bottom,rgba(255,255,255,.3),transparent)}

/* ==================== CATEGORY BANNERS ==================== */
.section{padding:80px 0}
.section-inner{max-width:1400px;margin:0 auto;padding:0 40px}
.section-label{font-size:11px;letter-spacing:.2em;text-transform:uppercase;color:var(--accent);margin-bottom:12px}
.section-title{font-family:'Cormorant Garamond',serif;font-size:clamp(32px,4vw,52px);font-weight:300;line-height:1.15;margin-bottom:48px}

.cat-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:24px}
.cat-grid-tall{grid-template-rows:400px 400px}
.cat-card{position:relative;overflow:hidden;border-radius:3px;cursor:pointer;background:var(--ink)}
.cat-card:nth-child(1){grid-row:span 2}
.cat-card-img{width:100%;height:100%;min-height:280px;object-fit:cover;transition:transform .6s ease;opacity:.8}
.cat-card:hover .cat-card-img{transform:scale(1.04);opacity:.9}
.cat-card-overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.7) 0%,transparent 60%);display:flex;flex-direction:column;justify-content:flex-end;padding:32px}
.cat-card-label{font-size:11px;letter-spacing:.2em;text-transform:uppercase;color:var(--accent);margin-bottom:6px}
.cat-card-title{font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:300;color:var(--white);margin-bottom:12px}
.cat-card-cta{font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:rgba(255,255,255,.7);display:flex;align-items:center;gap:8px;transition:color .2s}
.cat-card:hover .cat-card-cta{color:var(--accent)}
.cat-card-cta::after{content:'‚Üí';transition:transform .2s}
.cat-card:hover .cat-card-cta::after{transform:translateX(4px)}

/* Colored placeholder banners */
.banner-shirts{background:linear-gradient(135deg,#2c2c3e,#1a1a2e)}
.banner-tshirts{background:linear-gradient(135deg,#1a2a1a,#0f1f0f)}
.banner-pants{background:linear-gradient(135deg,#2a1a0f,#1a0f07)}
.banner-shoes{background:linear-gradient(135deg,#1a0a1a,#2a1535)}
.banner-shorts{background:linear-gradient(135deg,#0a1a2a,#051525)}
.banner-joggers{background:linear-gradient(135deg,#1a1a10,#0f0f07)}
.banner-accessories{background:linear-gradient(135deg,#2a1510,#1a0f08)}

.banner-inner{width:100%;height:100%;min-height:280px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
.banner-inner::before{content:'';position:absolute;inset:0;background-image:radial-gradient(circle at 30% 50%,rgba(200,169,110,.12),transparent 60%)}
.banner-emoji{font-size:80px;opacity:.15;position:absolute;right:32px;bottom:20px;line-height:1}

/* ==================== CATEGORY SWITCHER ==================== */
.cat-switcher{background:var(--ink);padding:64px 0}
.cat-switcher-inner{max-width:1400px;margin:0 auto;padding:0 40px}
.cat-tabs{display:flex;gap:0;border-bottom:1px solid rgba(255,255,255,.1);margin-bottom:48px;overflow-x:auto}
.cat-tab{padding:16px 28px;font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:rgba(255,255,255,.4);background:none;border:none;cursor:pointer;border-bottom:2px solid transparent;margin-bottom:-1px;white-space:nowrap;transition:all .2s}
.cat-tab:hover{color:rgba(255,255,255,.8)}
.cat-tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.featured-products{display:grid;grid-template-columns:repeat(4,1fr);gap:20px}
.feat-card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:3px;overflow:hidden;cursor:pointer;transition:all .25s}
.feat-card:hover{background:rgba(255,255,255,.08);transform:translateY(-4px)}
.feat-card-img{width:100%;aspect-ratio:3/4;display:flex;align-items:center;justify-content:center;font-size:64px;position:relative;overflow:hidden}
.feat-card-body{padding:20px}
.feat-card-cat{font-size:10px;letter-spacing:.15em;text-transform:uppercase;color:var(--accent);margin-bottom:6px}
.feat-card-name{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:300;color:var(--white);margin-bottom:8px}
.feat-card-price{font-size:15px;font-weight:500;color:var(--white)}
.feat-card-colors{display:flex;gap:6px;margin-top:10px}
.color-dot{width:14px;height:14px;border-radius:50%;border:2px solid rgba(255,255,255,.2)}

/* ==================== MARQUEE ==================== */
.marquee-section{background:var(--accent);padding:18px 0;overflow:hidden}
.marquee-track{display:flex;gap:0;animation:marquee 20s linear infinite;width:max-content}
.marquee-item{font-size:12px;letter-spacing:.15em;text-transform:uppercase;color:var(--white);padding:0 40px;display:flex;align-items:center;gap:40px;white-space:nowrap}
.marquee-item::after{content:'‚ú¶';font-size:8px}
@keyframes marquee{from{transform:translateX(0)}to{transform:translateX(-50%)}}

/* ==================== PROMO STRIP ==================== */
.promo-strip{display:flex;border-top:1px solid var(--border);border-bottom:1px solid var(--border)}
.promo-item{flex:1;padding:28px 32px;display:flex;align-items:center;gap:16px;border-right:1px solid var(--border)}
.promo-item:last-child{border-right:none}
.promo-icon{width:40px;height:40px;flex-shrink:0;color:var(--accent)}
.promo-icon svg{width:40px;height:40px;stroke:var(--accent);fill:none;stroke-width:1.2}
.promo-title{font-size:13px;font-weight:500;margin-bottom:2px}
.promo-desc{font-size:12px;color:var(--muted)}

/* ==================== NEWSLETTER ==================== */
.newsletter{background:var(--cream);padding:80px 0;text-align:center}
.newsletter-inner{max-width:560px;margin:0 auto;padding:0 40px}
.newsletter h2{font-family:'Cormorant Garamond',serif;font-size:40px;font-weight:300;margin-bottom:12px}
.newsletter p{font-size:15px;color:var(--muted);margin-bottom:32px;line-height:1.6}
.nl-form{display:flex;gap:0;border:1px solid var(--border);background:var(--white);border-radius:2px;overflow:hidden}
.nl-input{flex:1;padding:16px 20px;border:none;outline:none;font-family:'DM Sans',sans-serif;font-size:14px;background:transparent}
.nl-btn{padding:16px 24px;background:var(--ink);color:var(--white);border:none;font-size:12px;letter-spacing:.1em;text-transform:uppercase;cursor:pointer;transition:background .2s}
.nl-btn:hover{background:#2a2a2a}

/* ==================== FOOTER ==================== */
footer{background:var(--ink);color:rgba(255,255,255,.7);padding:64px 0 32px}
.footer-inner{max-width:1400px;margin:0 auto;padding:0 40px}
.footer-grid{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:48px;margin-bottom:48px}
.footer-brand{font-family:'Cormorant Garamond',serif;font-size:24px;font-weight:600;color:var(--white);margin-bottom:16px;letter-spacing:.05em}
.footer-desc{font-size:13px;line-height:1.8;color:rgba(255,255,255,.4)}
.footer-col h4{font-size:11px;letter-spacing:.2em;text-transform:uppercase;color:var(--accent);margin-bottom:20px}
.footer-col ul{list-style:none;display:flex;flex-direction:column;gap:10px}
.footer-col ul li a{font-size:13px;color:rgba(255,255,255,.5);cursor:pointer;transition:color .2s}
.footer-col ul li a:hover{color:var(--white)}
.footer-bottom{border-top:1px solid rgba(255,255,255,.08);padding-top:32px;display:flex;justify-content:space-between;align-items:center}
.footer-copy{font-size:12px;color:rgba(255,255,255,.3)}

/* ==================== PLP ==================== */
.plp-header{background:var(--ink);padding:64px 0 48px;text-align:center}
.plp-header-tag{font-size:11px;letter-spacing:.2em;text-transform:uppercase;color:var(--accent);margin-bottom:12px}
.plp-header-title{font-family:'Cormorant Garamond',serif;font-size:56px;font-weight:300;color:var(--white)}
.plp-header-count{font-size:13px;color:rgba(255,255,255,.4);margin-top:8px}
.plp-layout{max-width:1400px;margin:0 auto;padding:48px 40px;display:grid;grid-template-columns:260px 1fr;gap:48px}
.filter-panel{position:sticky;top:88px;height:fit-content}
.filter-section{margin-bottom:32px;padding-bottom:32px;border-bottom:1px solid var(--border)}
.filter-section:last-child{border-bottom:none}
.filter-title{font-size:11px;letter-spacing:.15em;text-transform:uppercase;font-weight:500;margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;cursor:pointer}
.filter-chevron{transition:transform .2s}
.filter-chevron.open{transform:rotate(180deg)}
.filter-opts{display:flex;flex-direction:column;gap:10px}
.filter-opt{display:flex;align-items:center;gap:10px;cursor:pointer;font-size:13px;color:var(--muted);transition:color .2s}
.filter-opt:hover,.filter-opt.active{color:var(--ink)}
.filter-check{width:16px;height:16px;border:1.5px solid var(--border);border-radius:2px;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all .15s}
.filter-opt.active .filter-check{background:var(--ink);border-color:var(--ink)}
.filter-opt.active .filter-check::after{content:'‚úì';font-size:10px;color:var(--white)}
.color-filter{display:flex;flex-wrap:wrap;gap:8px}
.color-filter-dot{width:24px;height:24px;border-radius:50%;cursor:pointer;transition:transform .2s;border:2px solid transparent}
.color-filter-dot:hover{transform:scale(1.15)}
.color-filter-dot.active{border-color:var(--ink)}
.price-range{display:flex;align-items:center;gap:12px;margin-top:12px}
.price-range input{width:80px;padding:8px 12px;border:1px solid var(--border);border-radius:2px;font-size:13px;font-family:'DM Sans',sans-serif}
.price-range span{color:var(--muted)}
.plp-toolbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px}
.active-filters{display:flex;gap:8px;flex-wrap:wrap}
.filter-tag{display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--cream);border-radius:20px;font-size:12px;cursor:pointer}
.filter-tag:hover{background:var(--border)}
.filter-tag span{color:var(--muted)}
.sort-select{padding:10px 16px;border:1px solid var(--border);border-radius:2px;font-size:13px;font-family:'DM Sans',sans-serif;background:var(--white);cursor:pointer;outline:none}
.product-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:28px}
.prod-card{cursor:pointer;group:true}
.prod-card-img{aspect-ratio:3/4;background:var(--cream);border-radius:3px;overflow:hidden;position:relative;margin-bottom:16px;display:flex;align-items:center;justify-content:center;font-size:64px;transition:transform .3s}
.prod-card:hover .prod-card-img{transform:translateY(-4px)}
.prod-card-img::after{content:attr(data-badge);position:absolute;top:12px;left:12px;background:var(--ink);color:var(--white);font-size:10px;letter-spacing:.1em;text-transform:uppercase;padding:4px 10px;border-radius:1px}
.prod-wishlist{position:absolute;top:12px;right:12px;width:32px;height:32px;background:var(--white);border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s;border:none}
.prod-card:hover .prod-wishlist{opacity:1}
.prod-wishlist svg{width:16px;height:16px;stroke:var(--ink);fill:none;stroke-width:1.5}
.prod-brand{font-size:10px;letter-spacing:.15em;text-transform:uppercase;color:var(--accent);margin-bottom:4px}
.prod-name{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:400;margin-bottom:6px}
.prod-meta{display:flex;justify-content:space-between;align-items:center}
.prod-price{font-size:15px;font-weight:500}
.prod-colors{display:flex;gap:5px}
.prod-color-dot{width:12px;height:12px;border-radius:50%;border:1.5px solid rgba(0,0,0,.15)}
.prod-rating{display:flex;align-items:center;gap:4px;font-size:12px;color:var(--muted);margin-top:6px}
.prod-stars{color:var(--accent)}

/* ==================== PDP ==================== */
.pdp-layout{max-width:1400px;margin:0 auto;padding:48px 40px;display:grid;grid-template-columns:1fr 1fr;gap:80px}
.pdp-gallery{display:flex;flex-direction:column;gap:12px}
.pdp-main-img{aspect-ratio:3/4;background:var(--cream);border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:120px;position:relative;overflow:hidden}
.pdp-thumbs{display:flex;gap:8px}
.pdp-thumb{width:80px;height:100px;background:var(--cream);border-radius:2px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:28px;border:2px solid transparent;transition:border-color .2s}
.pdp-thumb.active{border-color:var(--ink)}
.pdp-info{padding-top:16px}
.pdp-brand{font-size:11px;letter-spacing:.2em;text-transform:uppercase;color:var(--accent);margin-bottom:8px}
.pdp-name{font-family:'Cormorant Garamond',serif;font-size:42px;font-weight:300;line-height:1.15;margin-bottom:16px}
.pdp-rating{display:flex;align-items:center;gap:8px;margin-bottom:20px;font-size:13px;color:var(--muted)}
.pdp-price-row{display:flex;align-items:baseline;gap:12px;margin-bottom:28px}
.pdp-price{font-size:28px;font-weight:500}
.pdp-price-orig{font-size:18px;color:var(--muted);text-decoration:line-through}
.pdp-discount{font-size:13px;color:var(--success);font-weight:500;padding:4px 8px;background:rgba(39,174,96,.1);border-radius:2px}
.pdp-section-label{font-size:11px;letter-spacing:.15em;text-transform:uppercase;color:var(--muted);margin-bottom:12px}
.pdp-colors{display:flex;gap:10px;margin-bottom:28px}
.pdp-color{width:36px;height:36px;border-radius:50%;cursor:pointer;border:3px solid transparent;transition:all .2s;position:relative}
.pdp-color.active{border-color:var(--ink);transform:scale(1.1)}
.pdp-color[title]::after{content:attr(title);position:absolute;bottom:-24px;left:50%;transform:translateX(-50%);font-size:10px;white-space:nowrap;color:var(--muted)}
.pdp-sizes{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:28px}
.pdp-size{min-width:52px;height:44px;padding:0 12px;border:1.5px solid var(--border);border-radius:2px;background:var(--white);font-size:13px;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center}
.pdp-size:hover{border-color:var(--ink)}
.pdp-size.active{background:var(--ink);color:var(--white);border-color:var(--ink)}
.pdp-size.unavail{opacity:.35;cursor:not-allowed;text-decoration:line-through}
.pdp-qty-row{display:flex;align-items:center;gap:16px;margin-bottom:24px}
.qty-ctrl{display:flex;align-items:center;border:1.5px solid var(--border);border-radius:2px}
.qty-btn{width:40px;height:44px;border:none;background:none;font-size:18px;cursor:pointer;color:var(--ink);transition:background .2s}
.qty-btn:hover{background:var(--cream)}
.qty-val{width:48px;text-align:center;font-size:15px;font-weight:500}
.pdp-atc{flex:1;padding:16px;background:var(--ink);color:var(--white);border:none;font-size:13px;letter-spacing:.1em;text-transform:uppercase;font-weight:500;cursor:pointer;border-radius:2px;transition:background .2s}
.pdp-atc:hover{background:#2a2a2a}
.pdp-wishlist-btn{width:52px;height:52px;border:1.5px solid var(--border);border-radius:2px;background:var(--white);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s}
.pdp-wishlist-btn:hover{border-color:var(--ink)}
.pdp-wishlist-btn svg{width:20px;height:20px;stroke:var(--ink);fill:none;stroke-width:1.5}
.pdp-actions{display:flex;gap:12px;margin-bottom:32px}
.pdp-desc{font-size:14px;line-height:1.8;color:var(--muted);margin-bottom:28px}
.pdp-accordions{border-top:1px solid var(--border)}
.accordion{border-bottom:1px solid var(--border)}
.accordion-header{padding:18px 0;display:flex;justify-content:space-between;align-items:center;cursor:pointer;font-size:13px;font-weight:500;letter-spacing:.05em}
.accordion-body{padding-bottom:18px;font-size:13px;line-height:1.8;color:var(--muted);display:none}
.accordion.open .accordion-body{display:block}
.accordion.open .accordion-header::after{content:'‚àí'}
.accordion-header::after{content:'+';font-size:18px;color:var(--muted)}

/* ==================== CART ==================== */
.cart-layout{max-width:1200px;margin:0 auto;padding:48px 40px;display:grid;grid-template-columns:1fr 360px;gap:48px}
.cart-title{font-family:'Cormorant Garamond',serif;font-size:40px;font-weight:300;margin-bottom:32px}
.cart-item{display:grid;grid-template-columns:100px 1fr auto;gap:20px;padding:24px 0;border-bottom:1px solid var(--border);align-items:start}
.cart-item-img{width:100px;height:130px;background:var(--cream);border-radius:3px;display:flex;align-items:center;justify-content:center;font-size:36px}
.cart-item-name{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:400;margin-bottom:6px}
.cart-item-meta{font-size:12px;color:var(--muted);margin-bottom:12px}
.cart-item-qty{display:flex;align-items:center;gap:0;border:1px solid var(--border);border-radius:2px;width:fit-content}
.cart-item-qty button{width:32px;height:32px;border:none;background:none;font-size:16px;cursor:pointer;color:var(--ink)}
.cart-item-qty span{width:36px;text-align:center;font-size:13px;font-weight:500}
.cart-item-price{font-size:18px;font-weight:500;text-align:right}
.cart-item-remove{font-size:11px;color:var(--muted);text-decoration:underline;cursor:pointer;margin-top:8px;display:block;text-align:right;text-transform:uppercase;letter-spacing:.08em}
.cart-summary{background:var(--cream);padding:32px;border-radius:3px;position:sticky;top:88px;height:fit-content}
.cart-summary h3{font-family:'Cormorant Garamond',serif;font-size:24px;font-weight:400;margin-bottom:24px}
.summary-row{display:flex;justify-content:space-between;font-size:14px;margin-bottom:14px;color:var(--muted)}
.summary-row.total{font-size:18px;font-weight:600;color:var(--ink);border-top:1px solid var(--border);margin-top:16px;padding-top:16px}
.promo-code{display:flex;gap:0;border:1px solid var(--border);border-radius:2px;overflow:hidden;margin:16px 0 24px}
.promo-code input{flex:1;padding:12px 16px;border:none;outline:none;font-family:'DM Sans',sans-serif;font-size:13px}
.promo-code button{padding:12px 16px;background:var(--ink);color:var(--white);border:none;font-size:12px;letter-spacing:.1em;text-transform:uppercase;cursor:pointer}
.checkout-btn{width:100%;padding:18px;background:var(--ink);color:var(--white);border:none;font-size:13px;letter-spacing:.12em;text-transform:uppercase;font-weight:500;cursor:pointer;border-radius:2px;transition:background .2s;margin-bottom:12px}
.checkout-btn:hover{background:#2a2a2a}
.checkout-btn.gold{background:var(--accent)}
.checkout-btn.gold:hover{background:var(--accent-dark)}
.cart-empty{text-align:center;padding:80px 20px;grid-column:1/-1}
.cart-empty-icon{font-size:64px;margin-bottom:24px}
.cart-empty h2{font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:300;margin-bottom:12px}
.cart-empty p{color:var(--muted);font-size:14px;margin-bottom:28px}

/* ==================== CHECKOUT ==================== */
.checkout-layout{max-width:1100px;margin:0 auto;padding:48px 40px;display:grid;grid-template-columns:1fr 380px;gap:64px}
.checkout-steps{display:flex;gap:0;margin-bottom:40px;border-bottom:1px solid var(--border)}
.checkout-step{padding:16px 24px;font-size:12px;letter-spacing:.1em;text-transform:uppercase;color:var(--muted);display:flex;align-items:center;gap:10px;border-bottom:2px solid transparent;margin-bottom:-1px}
.checkout-step.active{color:var(--ink);border-bottom-color:var(--ink)}
.checkout-step.done{color:var(--success)}
.checkout-step-num{width:22px;height:22px;border-radius:50%;border:1.5px solid currentColor;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:600}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}
.form-grid.full{grid-template-columns:1fr}
.form-group{display:flex;flex-direction:column;gap:6px}
.form-group.span2{grid-column:span 2}
.form-label{font-size:11px;letter-spacing:.12em;text-transform:uppercase;color:var(--muted)}
.form-input{padding:14px 16px;border:1.5px solid var(--border);border-radius:2px;font-family:'DM Sans',sans-serif;font-size:14px;outline:none;transition:border-color .2s;background:var(--white)}
.form-input:focus{border-color:var(--ink)}
.form-select{padding:14px 16px;border:1.5px solid var(--border);border-radius:2px;font-family:'DM Sans',sans-serif;font-size:14px;outline:none;background:var(--white);cursor:pointer}
.section-divider{font-family:'Cormorant Garamond',serif;font-size:22px;font-weight:300;margin:32px 0 20px;padding-bottom:12px;border-bottom:1px solid var(--border)}
.delivery-options{display:flex;flex-direction:column;gap:12px;margin-bottom:28px}
.delivery-opt{display:flex;align-items:center;gap:16px;padding:16px 20px;border:1.5px solid var(--border);border-radius:3px;cursor:pointer;transition:all .2s}
.delivery-opt.active{border-color:var(--ink);background:var(--cream)}
.delivery-opt input[type=radio]{accent-color:var(--ink)}
.delivery-opt-info{flex:1}
.delivery-opt-name{font-size:14px;font-weight:500;margin-bottom:2px}
.delivery-opt-desc{font-size:12px;color:var(--muted)}
.delivery-opt-price{font-size:15px;font-weight:600}
.order-summary-panel{background:var(--cream);padding:28px;border-radius:3px;position:sticky;top:88px;height:fit-content}
.order-item-row{display:flex;gap:12px;margin-bottom:14px;align-items:center}
.order-item-img{width:52px;height:66px;background:var(--border);border-radius:2px;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:20px;position:relative}
.order-item-badge{position:absolute;top:-6px;right:-6px;width:18px;height:18px;background:var(--ink);color:var(--white);border-radius:50%;font-size:10px;display:flex;align-items:center;justify-content:center;font-weight:600}
.order-item-name{font-size:13px;font-weight:500;margin-bottom:2px}
.order-item-meta{font-size:11px;color:var(--muted)}
.order-item-price{font-size:14px;font-weight:500;margin-left:auto}

/* ==================== PAYMENT ==================== */
.payment-methods{display:flex;gap:12px;margin-bottom:28px}
.pay-method{flex:1;padding:16px;border:1.5px solid var(--border);border-radius:3px;display:flex;align-items:center;justify-content:center;gap:8px;cursor:pointer;font-size:13px;transition:all .2s;background:var(--white)}
.pay-method.active{border-color:var(--ink);background:var(--cream)}
.card-preview{background:linear-gradient(135deg,#1a1a1a,#3a3a3a);border-radius:12px;padding:28px;margin-bottom:28px;color:var(--white);position:relative;overflow:hidden}
.card-preview::before{content:'';position:absolute;top:-40px;right:-40px;width:200px;height:200px;border-radius:50%;background:rgba(200,169,110,.15)}
.card-chip{width:36px;height:28px;background:linear-gradient(135deg,#d4a96e,#a8803a);border-radius:4px;margin-bottom:28px}
.card-number{font-size:18px;letter-spacing:.15em;margin-bottom:24px;font-family:'Courier New',monospace}
.card-row{display:flex;justify-content:space-between}
.card-label{font-size:9px;letter-spacing:.2em;text-transform:uppercase;opacity:.6;margin-bottom:4px}
.card-val{font-size:13px;letter-spacing:.05em}
.card-network{position:absolute;top:28px;right:28px;font-size:24px}
.place-order-btn{width:100%;padding:20px;background:var(--accent);color:var(--white);border:none;font-size:14px;letter-spacing:.12em;text-transform:uppercase;font-weight:500;cursor:pointer;border-radius:2px;transition:all .25s;margin-top:12px}
.place-order-btn:hover{background:var(--accent-dark);transform:translateY(-1px)}
.secure-badge{display:flex;align-items:center;justify-content:center;gap:8px;font-size:11px;color:var(--muted);margin-top:12px}

/* ==================== THANK YOU ==================== */
.thankyou{min-height:70vh;display:flex;align-items:center;justify-content:center;padding:80px 40px;text-align:center}
.thankyou-inner{max-width:600px}
.ty-icon{width:80px;height:80px;background:linear-gradient(135deg,var(--accent),var(--accent-dark));border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 32px;animation:popIn .5s cubic-bezier(0.175,0.885,0.32,1.275) forwards}
@keyframes popIn{from{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}
.ty-icon svg{width:36px;height:36px;stroke:var(--white);fill:none;stroke-width:2}
.ty-tag{font-size:11px;letter-spacing:.2em;text-transform:uppercase;color:var(--accent);margin-bottom:12px}
.ty-title{font-family:'Cormorant Garamond',serif;font-size:52px;font-weight:300;margin-bottom:16px;line-height:1.1}
.ty-subtitle{font-size:15px;color:var(--muted);line-height:1.8;margin-bottom:40px}
.ty-order{background:var(--cream);padding:28px;border-radius:3px;margin-bottom:32px;text-align:left}
.ty-order-row{display:flex;justify-content:space-between;font-size:13px;margin-bottom:10px;color:var(--muted)}
.ty-order-row:last-child{margin-bottom:0}
.ty-order-row strong{color:var(--ink)}
.ty-steps{display:flex;gap:24px;justify-content:center;margin-bottom:40px}
.ty-step{flex:1;max-width:160px;text-align:center}
.ty-step-icon{width:48px;height:48px;border-radius:50%;background:var(--cream);display:flex;align-items:center;justify-content:center;margin:0 auto 12px}
.ty-step-icon svg{width:22px;height:22px;stroke:var(--accent);fill:none;stroke-width:1.5}
.ty-step p{font-size:12px;color:var(--muted);line-height:1.5}
.ty-step strong{font-size:13px;display:block;margin-bottom:4px}
.ty-btns{display:flex;gap:12px;justify-content:center}

/* ==================== TOAST ==================== */
.toast{position:fixed;bottom:32px;right:32px;background:var(--ink);color:var(--white);padding:16px 24px;border-radius:3px;font-size:13px;display:flex;align-items:center;gap:12px;z-index:1000;transform:translateY(80px);opacity:0;transition:all .3s cubic-bezier(0.175,0.885,0.32,1.275)}
.toast.show{transform:translateY(0);opacity:1}
.toast svg{width:18px;height:18px;stroke:var(--accent);fill:none;stroke-width:2}

/* ==================== BREADCRUMB ==================== */
.breadcrumb{background:var(--cream);padding:12px 0;border-bottom:1px solid var(--border)}
.breadcrumb-inner{max-width:1400px;margin:0 auto;padding:0 40px;display:flex;align-items:center;gap:8px;font-size:12px;color:var(--muted)}
.breadcrumb a{cursor:pointer;transition:color .2s}
.breadcrumb a:hover{color:var(--ink)}
.breadcrumb-sep{color:var(--border)}

/* ==================== SCROLL TO TOP ==================== */
.scroll-top{position:fixed;bottom:32px;left:32px;width:44px;height:44px;background:var(--ink);border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;opacity:0;transform:translateY(16px);transition:all .3s;z-index:100}
.scroll-top.visible{opacity:1;transform:translateY(0)}
.scroll-top svg{width:18px;height:18px;stroke:var(--white);fill:none;stroke-width:2}

@media(max-width:900px){
  .product-grid{grid-template-columns:repeat(2,1fr)}
  .plp-layout{grid-template-columns:1fr}
  .cart-layout,.checkout-layout,.pdp-layout{grid-template-columns:1fr}
  .cat-grid{grid-template-columns:1fr 1fr}
  .cat-card:nth-child(1){grid-row:span 1}
  .featured-products{grid-template-columns:repeat(2,1fr)}
  .footer-grid{grid-template-columns:1fr 1fr}
  .promo-strip{flex-direction:column}
  .promo-item{border-right:none;border-bottom:1px solid var(--border)}
}
</style>
</head>
<body>

<!-- NAV -->
<nav id="main-nav">
  <div class="nav-inner">
    <div class="nav-logo" onclick="goTo('home')">DUKE<span>.</span></div>
    <ul class="nav-links">
      <li><a onclick="goTo('home')" id="nav-home">Home</a></li>
      <li><a onclick="goToPLP('Shirts')" id="nav-shop">Shop</a></li>
      <li><a onclick="goToPLP('Shirts')">Collections</a></li>
      <li><a>About</a></li>
    </ul>
    <div class="nav-actions">
      <button class="nav-icon" title="Search">
        <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      </button>
      <button class="nav-icon" title="Wishlist">
        <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
      </button>
      <button class="nav-icon" title="Cart" onclick="goTo('cart')">
        <svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
        <span class="cart-badge" id="cart-badge">0</span>
      </button>
    </div>
  </div>
</nav>

<!-- ==================== HOME PAGE ==================== -->
<div class="page" id="page-home">
  <!-- Hero -->
  <section class="hero">
    <div class="hero-bg"></div>
    <div class="hero-pattern"></div>
    <div class="hero-content">
      <p class="hero-tag">New Collection ‚Äî Spring 2025</p>
      <h1 class="hero-title">Dress<br>with<br><em>Duke.</em></h1>
      <p class="hero-subtitle">Duke ‚Äî precision-crafted essentials for the modern individual. Where form meets purpose.</p>
      <div class="hero-btns">
        <button class="btn-primary" onclick="goToPLP('Shirts')">Explore Collection</button>
        <button class="btn-outline" onclick="scrollToCats()">Shop by Category</button>
      </div>
    </div>
    <div class="hero-scroll">
      <div class="hero-scroll-line"></div>
      <span>Scroll</span>
    </div>
  </section>

  <!-- Marquee -->
  <div class="marquee-section">
    <div class="marquee-track">
      <span class="marquee-item">Premium Craftsmanship</span>
      <span class="marquee-item">Free Shipping Over ‚Çπ999</span>
      <span class="marquee-item">Sustainable Materials</span>
      <span class="marquee-item">Easy 30-Day Returns</span>
      <span class="marquee-item">New Arrivals Weekly</span>
      <span class="marquee-item">Premium Craftsmanship</span>
      <span class="marquee-item">Free Shipping Over ‚Çπ999</span>
      <span class="marquee-item">Sustainable Materials</span>
      <span class="marquee-item">Easy 30-Day Returns</span>
      <span class="marquee-item">New Arrivals Weekly</span>
    </div>
  </div>

  <!-- Category Banners -->
  <section class="section" id="categories-section">
    <div class="section-inner">
      <p class="section-label">Shop by Category</p>
      <h2 class="section-title">Curated for Every<br>Occasion</h2>
      <div class="cat-grid cat-grid-tall">
        <div class="cat-card" onclick="goToPLP('Shirts')">
          <div class="banner-inner banner-shirts" style="min-height:100%;height:100%">
            <div class="banner-emoji">üëî</div>
            <div style="position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.8) 0%,transparent 60%)"></div>
          </div>
          <div class="cat-card-overlay">
            <p class="cat-card-label">New In</p>
            <h3 class="cat-card-title">Shirts</h3>
            <span class="cat-card-cta">View All</span>
          </div>
        </div>
        <div class="cat-card" onclick="goToPLP('T-Shirts')">
          <div class="banner-inner banner-tshirts">
            <div class="banner-emoji">üëï</div>
            <div style="position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.8) 0%,transparent 60%)"></div>
          </div>
          <div class="cat-card-overlay">
            <p class="cat-card-label">Essentials</p>
            <h3 class="cat-card-title">T-Shirts</h3>
            <span class="cat-card-cta">View All</span>
          </div>
        </div>
        <div class="cat-card" onclick="goToPLP('Pants')">
          <div class="banner-inner banner-pants">
            <div class="banner-emoji">üëñ</div>
            <div style="position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.8) 0%,transparent 60%)"></div>
          </div>
          <div class="cat-card-overlay">
            <p class="cat-card-label">Tailored</p>
            <h3 class="cat-card-title">Pants</h3>
            <span class="cat-card-cta">View All</span>
          </div>
        </div>
        <div class="cat-card" onclick="goToPLP('Shoes')">
          <div class="banner-inner banner-shoes">
            <div class="banner-emoji">üëü</div>
            <div style="position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.8) 0%,transparent 60%)"></div>
          </div>
          <div class="cat-card-overlay">
            <p class="cat-card-label">Step Up</p>
            <h3 class="cat-card-title">Shoes</h3>
            <span class="cat-card-cta">View All</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Small Banners Row -->
  <section class="section" style="padding-top:0">
    <div class="section-inner">
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px">
        <div class="cat-card" onclick="goToPLP('Shorts')">
          <div class="banner-inner banner-shorts" style="min-height:220px">
            <div class="banner-emoji" style="font-size:60px">ü©≤</div>
            <div style="position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.8) 0%,transparent 60%)"></div>
          </div>
          <div class="cat-card-overlay" style="padding:20px">
            <p class="cat-card-label">Active</p>
            <h3 class="cat-card-title" style="font-size:24px">Shorts</h3>
            <span class="cat-card-cta">View All</span>
          </div>
        </div>
        <div class="cat-card" onclick="goToPLP('Joggers')">
          <div class="banner-inner banner-joggers" style="min-height:220px">
            <div class="banner-emoji" style="font-size:60px">üèÉ</div>
            <div style="position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.8) 0%,transparent 60%)"></div>
          </div>
          <div class="cat-card-overlay" style="padding:20px">
            <p class="cat-card-label">Comfort</p>
            <h3 class="cat-card-title" style="font-size:24px">Joggers</h3>
            <span class="cat-card-cta">View All</span>
          </div>
        </div>
        <div class="cat-card" onclick="goToPLP('Accessories')">
          <div class="banner-inner banner-accessories" style="min-height:220px">
            <div class="banner-emoji" style="font-size:60px">üéí</div>
            <div style="position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.8) 0%,transparent 60%)"></div>
          </div>
          <div class="cat-card-overlay" style="padding:20px">
            <p class="cat-card-label">Finishing</p>
            <h3 class="cat-card-title" style="font-size:24px">Accessories</h3>
            <span class="cat-card-cta">View All</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Category Switcher -->
  <section class="cat-switcher">
    <div class="cat-switcher-inner">
      <p class="section-label" style="color:rgba(255,255,255,.4)">Featured Products</p>
      <h2 class="section-title" style="color:var(--white);margin-bottom:36px">Trending This Week</h2>
      <div class="cat-tabs" id="cat-tabs">
        <button class="cat-tab active" onclick="switchCat('Shirts')">Shirts</button>
        <button class="cat-tab" onclick="switchCat('T-Shirts')">T-Shirts</button>
        <button class="cat-tab" onclick="switchCat('Pants')">Pants</button>
        <button class="cat-tab" onclick="switchCat('Shoes')">Shoes</button>
        <button class="cat-tab" onclick="switchCat('Shorts')">Shorts</button>
        <button class="cat-tab" onclick="switchCat('Joggers')">Joggers</button>
        <button class="cat-tab" onclick="switchCat('Accessories')">Accessories</button>
      </div>
      <div class="featured-products" id="featured-products"></div>
    </div>
  </section>

  <!-- Promo Strip -->
  <div class="promo-strip">
    <div class="promo-item">
      <div class="promo-icon">
        <svg viewBox="0 0 24 24"><path d="M5 12h14"/><path d="M12 5l7 7-7 7"/></svg>
      </div>
      <div>
        <p class="promo-title">Free Shipping</p>
        <p class="promo-desc">On orders over ‚Çπ999</p>
      </div>
    </div>
    <div class="promo-item">
      <div class="promo-icon">
        <svg viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>
      </div>
      <div>
        <p class="promo-title">Easy Returns</p>
        <p class="promo-desc">30-day hassle-free returns</p>
      </div>
    </div>
    <div class="promo-item">
      <div class="promo-icon">
        <svg viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
      </div>
      <div>
        <p class="promo-title">Secure Payments</p>
        <p class="promo-desc">256-bit SSL encryption</p>
      </div>
    </div>
    <div class="promo-item">
      <div class="promo-icon">
        <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
      </div>
      <div>
        <p class="promo-title">Expert Support</p>
        <p class="promo-desc">Mon-Sat, 9AM‚Äì7PM</p>
      </div>
    </div>
  </div>

  <!-- Newsletter -->
  <section class="newsletter">
    <div class="newsletter-inner">
      <p class="section-label">Stay in the Loop</p>
      <h2>Exclusive Access,<br>Early Drops.</h2>
      <p>Subscribe for new arrivals, style inspiration, and members-only offers.</p>
      <div class="nl-form">
        <input class="nl-input" type="email" placeholder="your@email.com">
        <button class="nl-btn">Subscribe</button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="footer-inner">
      <div class="footer-grid">
        <div>
          <div class="footer-brand">DUKE.</div>
          <p class="footer-desc">Precision-crafted apparel for those who refuse to compromise between comfort and character.</p>
        </div>
        <div class="footer-col">
          <h4>Shop</h4>
          <ul>
            <li><a onclick="goToPLP('Shirts')">Shirts</a></li>
            <li><a onclick="goToPLP('T-Shirts')">T-Shirts</a></li>
            <li><a onclick="goToPLP('Pants')">Pants</a></li>
            <li><a onclick="goToPLP('Shoes')">Shoes</a></li>
            <li><a onclick="goToPLP('Accessories')">Accessories</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Help</h4>
          <ul>
            <li><a>Size Guide</a></li>
            <li><a>Shipping Info</a></li>
            <li><a>Returns</a></li>
            <li><a>Track Order</a></li>
            <li><a>Contact Us</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>About</h4>
          <ul>
            <li><a>Our Story</a></li>
            <li><a>Sustainability</a></li>
            <li><a>Careers</a></li>
            <li><a>Press</a></li>
            <li><a>Privacy Policy</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <span class="footer-copy">¬© 2025 Duke. All rights reserved.</span>
        <span class="footer-copy">Made with intention.</span>
      </div>
    </div>
  </footer>
</div>

<!-- ==================== PLP PAGE ==================== -->
<div class="page" id="page-plp">
  <div class="plp-header">
    <p class="plp-header-tag" id="plp-tag">Category</p>
    <h1 class="plp-header-title" id="plp-title">Products</h1>
    <p class="plp-header-count" id="plp-count">10 Products</p>
  </div>
  <div class="breadcrumb">
    <div class="breadcrumb-inner">
      <a onclick="goTo('home')">Home</a>
      <span class="breadcrumb-sep">‚Ä∫</span>
      <a>Shop</a>
      <span class="breadcrumb-sep">‚Ä∫</span>
      <span id="plp-breadcrumb">Category</span>
    </div>
  </div>
  <div class="plp-layout">
    <!-- Filters -->
    <aside class="filter-panel">
      <div class="filter-section">
        <div class="filter-title" onclick="toggleFilter(this)">
          Price Range
          <span class="filter-chevron open">‚ñæ</span>
        </div>
        <div class="filter-opts">
          <label class="filter-opt active" onclick="toggleFilterOpt(this)">
            <span class="filter-check"></span>Under ‚Çπ999
          </label>
          <label class="filter-opt" onclick="toggleFilterOpt(this)">
            <span class="filter-check"></span>‚Çπ999 ‚Äì ‚Çπ1,999
          </label>
          <label class="filter-opt" onclick="toggleFilterOpt(this)">
            <span class="filter-check"></span>‚Çπ1,999 ‚Äì ‚Çπ3,499
          </label>
          <label class="filter-opt" onclick="toggleFilterOpt(this)">
            <span class="filter-check"></span>Above ‚Çπ3,499
          </label>
        </div>
      </div>
      <div class="filter-section">
        <div class="filter-title" onclick="toggleFilter(this)">
          Color
          <span class="filter-chevron open">‚ñæ</span>
        </div>
        <div class="color-filter">
          <div class="color-filter-dot active" style="background:#1a1a1a" title="Black" onclick="toggleColorFilter(this)"></div>
          <div class="color-filter-dot" style="background:#f5f5f5;border:1px solid #ddd" title="White" onclick="toggleColorFilter(this)"></div>
          <div class="color-filter-dot" style="background:#4a5568" title="Slate" onclick="toggleColorFilter(this)"></div>
          <div class="color-filter-dot" style="background:#8B4513" title="Brown" onclick="toggleColorFilter(this)"></div>
          <div class="color-filter-dot" style="background:#2d5a27" title="Forest" onclick="toggleColorFilter(this)"></div>
          <div class="color-filter-dot" style="background:#c0392b" title="Rust" onclick="toggleColorFilter(this)"></div>
          <div class="color-filter-dot" style="background:#c8a96e" title="Camel" onclick="toggleColorFilter(this)"></div>
          <div class="color-filter-dot" style="background:#1e3a5f" title="Navy" onclick="toggleColorFilter(this)"></div>
        </div>
      </div>
      <div class="filter-section">
        <div class="filter-title" onclick="toggleFilter(this)">
          Size
          <span class="filter-chevron open">‚ñæ</span>
        </div>
        <div style="display:flex;flex-wrap:wrap;gap:8px">
          <button class="pdp-size active" style="min-width:40px;height:36px">XS</button>
          <button class="pdp-size" style="min-width:40px;height:36px">S</button>
          <button class="pdp-size" style="min-width:40px;height:36px">M</button>
          <button class="pdp-size" style="min-width:40px;height:36px">L</button>
          <button class="pdp-size" style="min-width:40px;height:36px">XL</button>
          <button class="pdp-size" style="min-width:40px;height:36px">XXL</button>
        </div>
      </div>
      <div class="filter-section">
        <div class="filter-title" onclick="toggleFilter(this)">
          Rating
          <span class="filter-chevron open">‚ñæ</span>
        </div>
        <div class="filter-opts">
          <label class="filter-opt" onclick="toggleFilterOpt(this)">
            <span class="filter-check"></span>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ 5 Stars
          </label>
          <label class="filter-opt active" onclick="toggleFilterOpt(this)">
            <span class="filter-check"></span>‚òÖ‚òÖ‚òÖ‚òÖ & Above
          </label>
          <label class="filter-opt" onclick="toggleFilterOpt(this)">
            <span class="filter-check"></span>‚òÖ‚òÖ‚òÖ & Above
          </label>
        </div>
      </div>
    </aside>

    <!-- Products -->
    <main>
      <div class="plp-toolbar">
        <div class="active-filters">
          <span class="filter-tag">Black <span>‚úï</span></span>
          <span class="filter-tag">4‚òÖ & Above <span>‚úï</span></span>
          <span style="font-size:12px;color:var(--muted);align-self:center;cursor:pointer;text-decoration:underline">Clear all</span>
        </div>
        <select class="sort-select" onchange="sortProducts(this.value)">
          <option value="featured">Sort: Featured</option>
          <option value="price-asc">Price: Low to High</option>
          <option value="price-desc">Price: High to Low</option>
          <option value="newest">Newest First</option>
          <option value="rating">Top Rated</option>
        </select>
      </div>
      <div class="product-grid" id="product-grid"></div>
    </main>
  </div>
</div>

<!-- ==================== PDP PAGE ==================== -->
<div class="page" id="page-pdp">
  <div class="breadcrumb">
    <div class="breadcrumb-inner">
      <a onclick="goTo('home')">Home</a>
      <span class="breadcrumb-sep">‚Ä∫</span>
      <a id="pdp-cat-link">Category</a>
      <span class="breadcrumb-sep">‚Ä∫</span>
      <span id="pdp-name-bc">Product</span>
    </div>
  </div>
  <div class="pdp-layout">
    <div class="pdp-gallery">
      <div class="pdp-main-img" id="pdp-main-img"><span id="pdp-emoji">üëï</span></div>
      <div class="pdp-thumbs" id="pdp-thumbs"></div>
    </div>
    <div class="pdp-info">
      <p class="pdp-brand" id="pdp-brand">FORM</p>
      <h1 class="pdp-name" id="pdp-name">Product Name</h1>
      <div class="pdp-rating">
        <span class="prod-stars" id="pdp-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
        <span id="pdp-rating-count">(128 reviews)</span>
      </div>
      <div class="pdp-price-row">
        <span class="pdp-price" id="pdp-price">‚Çπ1,499</span>
        <span class="pdp-price-orig" id="pdp-price-orig"></span>
        <span class="pdp-discount hidden" id="pdp-discount"></span>
      </div>
      <p class="pdp-section-label">Select Color</p>
      <div class="pdp-colors" id="pdp-colors"></div>
      <p class="pdp-section-label">Select Size <a style="float:right;font-size:11px;color:var(--accent);text-decoration:underline;cursor:pointer">Size Guide</a></p>
      <div class="pdp-sizes" id="pdp-sizes">
        <button class="pdp-size" onclick="selectSize(this)">XS</button>
        <button class="pdp-size active" onclick="selectSize(this)">S</button>
        <button class="pdp-size" onclick="selectSize(this)">M</button>
        <button class="pdp-size" onclick="selectSize(this)">L</button>
        <button class="pdp-size" onclick="selectSize(this)">XL</button>
        <button class="pdp-size unavail" onclick="selectSize(this)">XXL</button>
      </div>
      <div class="pdp-qty-row">
        <div class="qty-ctrl">
          <button class="qty-btn" onclick="changeQty(-1)">‚àí</button>
          <span class="qty-val" id="pdp-qty">1</span>
          <button class="qty-btn" onclick="changeQty(1)">+</button>
        </div>
        <div class="pdp-actions" style="flex:1;margin-bottom:0">
          <button class="pdp-atc" onclick="addToCartFromPDP()">Add to Cart</button>
          <button class="pdp-wishlist-btn">
            <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
          </button>
        </div>
      </div>
      <p class="pdp-desc" id="pdp-desc">Premium quality craftsmanship with attention to every detail. This piece combines modern design with timeless style, making it perfect for any occasion. Crafted from sustainably sourced materials.</p>
      <div class="pdp-accordions">
        <div class="accordion open">
          <div class="accordion-header" onclick="toggleAccordion(this)">Product Details</div>
          <div class="accordion-body" id="pdp-details">Material: 100% Organic Cotton<br>Fit: Regular<br>Care: Machine wash cold<br>Country of Origin: India</div>
        </div>
        <div class="accordion">
          <div class="accordion-header" onclick="toggleAccordion(this)">Size & Fit</div>
          <div class="accordion-body">Model is 6'1" and wears size M. True to size. For a looser fit, we recommend sizing up.</div>
        </div>
        <div class="accordion">
          <div class="accordion-header" onclick="toggleAccordion(this)">Shipping & Returns</div>
          <div class="accordion-body">Free shipping on orders above ‚Çπ999. Delivered in 3‚Äì5 business days. Easy 30-day returns ‚Äî just drop it back in any India Post box.</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ==================== CART PAGE ==================== -->
<div class="page" id="page-cart">
  <div style="max-width:1200px;margin:0 auto;padding:48px 40px 16px">
    <h1 class="cart-title">Your Cart</h1>
  </div>
  <div class="cart-layout" id="cart-layout"></div>
</div>

<!-- ==================== CHECKOUT ‚Äî DELIVERY ==================== -->
<div class="page" id="page-checkout">
  <div class="checkout-layout">
    <div>
      <div class="checkout-steps">
        <div class="checkout-step done">
          <span class="checkout-step-num">‚úì</span> Cart
        </div>
        <div class="checkout-step active">
          <span class="checkout-step-num">2</span> Delivery
        </div>
        <div class="checkout-step">
          <span class="checkout-step-num">3</span> Payment
        </div>
        <div class="checkout-step">
          <span class="checkout-step-num">4</span> Confirm
        </div>
      </div>
      <h2 class="section-divider" style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300">Contact Information</h2>
      <div class="form-grid">
        <div class="form-group">
          <label class="form-label">First Name</label>
          <input class="form-input" type="text" placeholder="Arjun" id="fname">
        </div>
        <div class="form-group">
          <label class="form-label">Last Name</label>
          <input class="form-input" type="text" placeholder="Sharma">
        </div>
        <div class="form-group">
          <label class="form-label">Email</label>
          <input class="form-input" type="email" placeholder="you@example.com">
        </div>
        <div class="form-group">
          <label class="form-label">Phone</label>
          <input class="form-input" type="tel" placeholder="+91 98765 43210">
        </div>
      </div>
      <h2 class="section-divider" style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300">Delivery Address</h2>
      <div class="form-grid">
        <div class="form-group span2">
          <label class="form-label">Address Line 1</label>
          <input class="form-input" type="text" placeholder="Street address, flat number">
        </div>
        <div class="form-group span2">
          <label class="form-label">Address Line 2 (Optional)</label>
          <input class="form-input" type="text" placeholder="Colony, Landmark">
        </div>
        <div class="form-group">
          <label class="form-label">City</label>
          <input class="form-input" type="text" placeholder="Mumbai">
        </div>
        <div class="form-group">
          <label class="form-label">State</label>
          <select class="form-select">
            <option>Maharashtra</option>
            <option>Tamil Nadu</option>
            <option>Karnataka</option>
            <option>Delhi</option>
            <option>Gujarat</option>
            <option>Rajasthan</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">PIN Code</label>
          <input class="form-input" type="text" placeholder="400001">
        </div>
        <div class="form-group">
          <label class="form-label">Country</label>
          <select class="form-select"><option>India</option></select>
        </div>
      </div>
      <h2 class="section-divider" style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300">Delivery Method</h2>
      <div class="delivery-options">
        <label class="delivery-opt active" onclick="selectDelivery(this)">
          <input type="radio" name="delivery" checked>
          <div class="delivery-opt-info">
            <p class="delivery-opt-name">Standard Delivery</p>
            <p class="delivery-opt-desc">3‚Äì5 business days ¬∑ India Post / Delhivery</p>
          </div>
          <span class="delivery-opt-price">Free</span>
        </label>
        <label class="delivery-opt" onclick="selectDelivery(this)">
          <input type="radio" name="delivery">
          <div class="delivery-opt-info">
            <p class="delivery-opt-name">Express Delivery</p>
            <p class="delivery-opt-desc">1‚Äì2 business days ¬∑ BlueDart</p>
          </div>
          <span class="delivery-opt-price">‚Çπ99</span>
        </label>
        <label class="delivery-opt" onclick="selectDelivery(this)">
          <input type="radio" name="delivery">
          <div class="delivery-opt-info">
            <p class="delivery-opt-name">Same Day Delivery</p>
            <p class="delivery-opt-desc">Available in select cities ¬∑ Before 8PM</p>
          </div>
          <span class="delivery-opt-price">‚Çπ199</span>
        </label>
      </div>
      <button class="checkout-btn" onclick="fireCheckoutStep(2,'delivery');goTo('payment')">Continue to Payment ‚Üí</button>
    </div>
    <div class="order-summary-panel">
      <h3 style="font-family:'Cormorant Garamond',serif;font-size:22px;font-weight:400;margin-bottom:20px">Order Summary</h3>
      <div id="checkout-items"></div>
      <div style="border-top:1px solid var(--border);margin-top:16px;padding-top:16px">
        <div class="summary-row"><span>Subtotal</span><span id="co-subtotal">‚Çπ0</span></div>
        <div class="summary-row"><span>Shipping</span><span>Free</span></div>
        <div class="summary-row"><span>GST (18%)</span><span id="co-gst">‚Çπ0</span></div>
        <div class="summary-row total"><span>Total</span><span id="co-total">‚Çπ0</span></div>
      </div>
    </div>
  </div>
</div>

<!-- ==================== PAYMENT PAGE ==================== -->
<div class="page" id="page-payment">
  <div class="checkout-layout">
    <div>
      <div class="checkout-steps">
        <div class="checkout-step done"><span class="checkout-step-num">‚úì</span> Cart</div>
        <div class="checkout-step done"><span class="checkout-step-num">‚úì</span> Delivery</div>
        <div class="checkout-step active"><span class="checkout-step-num">3</span> Payment</div>
        <div class="checkout-step"><span class="checkout-step-num">4</span> Confirm</div>
      </div>
      <h2 class="section-divider" style="font-family:'Cormorant Garamond',serif;font-size:28px;font-weight:300">Payment Method</h2>
      <div class="payment-methods">
        <button class="pay-method active" onclick="selectPayMethod(this,'card')">üí≥ Card</button>
        <button class="pay-method" onclick="selectPayMethod(this,'upi')">üì± UPI</button>
        <button class="pay-method" onclick="selectPayMethod(this,'netbank')">üè¶ Net Banking</button>
        <button class="pay-method" onclick="selectPayMethod(this,'cod')">üíµ COD</button>
      </div>

      <!-- Card Form -->
      <div id="pay-card-form">
        <div class="card-preview">
          <div class="card-chip"></div>
          <div class="card-number" id="preview-number">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
          <div class="card-row">
            <div>
              <p class="card-label">Card Holder</p>
              <p class="card-val" id="preview-name">YOUR NAME</p>
            </div>
            <div>
              <p class="card-label">Expires</p>
              <p class="card-val" id="preview-expiry">MM/YY</p>
            </div>
          </div>
          <div class="card-network">üí≥</div>
        </div>
        <div class="form-grid">
          <div class="form-group span2">
            <label class="form-label">Card Number</label>
            <input class="form-input" type="text" placeholder="1234 5678 9012 3456" maxlength="19" oninput="updateCardPreview(this,'number')">
          </div>
          <div class="form-group span2">
            <label class="form-label">Card Holder Name</label>
            <input class="form-input" type="text" placeholder="Arjun Sharma" oninput="updateCardPreview(this,'name')">
          </div>
          <div class="form-group">
            <label class="form-label">Expiry Date</label>
            <input class="form-input" type="text" placeholder="MM/YY" maxlength="5" oninput="updateCardPreview(this,'expiry')">
          </div>
          <div class="form-group">
            <label class="form-label">CVV</label>
            <input class="form-input" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢" maxlength="3">
          </div>
        </div>
      </div>

      <!-- UPI Form -->
      <div id="pay-upi-form" class="hidden">
        <div class="form-group" style="margin-bottom:16px">
          <label class="form-label">UPI ID</label>
          <input class="form-input" type="text" placeholder="yourname@upi">
        </div>
        <p style="font-size:13px;color:var(--muted)">You will receive a payment request on your UPI app.</p>
      </div>

      <!-- Net Banking Form -->
      <div id="pay-netbank-form" class="hidden">
        <div class="form-group" style="margin-bottom:16px">
          <label class="form-label">Select Bank</label>
          <select class="form-select" style="width:100%">
            <option>State Bank of India</option>
            <option>HDFC Bank</option>
            <option>ICICI Bank</option>
            <option>Axis Bank</option>
            <option>Kotak Mahindra Bank</option>
          </select>
        </div>
      </div>

      <!-- COD Info -->
      <div id="pay-cod-form" class="hidden">
        <div style="background:var(--cream);padding:20px;border-radius:3px;font-size:14px;line-height:1.7;color:var(--muted)">
          <strong style="color:var(--ink)">Cash on Delivery</strong><br>
          Pay when your order arrives. Available for orders under ‚Çπ5,000. An additional ‚Çπ49 COD charge applies.
        </div>
      </div>

      <button class="place-order-btn" onclick="placeOrder()">Place Order Securely ‚Üí</button>
      <div class="secure-badge">
        <svg viewBox="0 0 24 24" width="14" height="14"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" stroke="currentColor" fill="none" stroke-width="1.5"/></svg>
        SSL secured ¬∑ PCI DSS compliant
      </div>
    </div>

    <div class="order-summary-panel">
      <h3 style="font-family:'Cormorant Garamond',serif;font-size:22px;font-weight:400;margin-bottom:20px">Order Summary</h3>
      <div id="payment-items"></div>
      <div style="border-top:1px solid var(--border);margin-top:16px;padding-top:16px">
        <div class="summary-row"><span>Subtotal</span><span id="pay-subtotal">‚Çπ0</span></div>
        <div class="summary-row"><span>Shipping</span><span>Free</span></div>
        <div class="summary-row"><span>GST (18%)</span><span id="pay-gst">‚Çπ0</span></div>
        <div class="summary-row total"><span>Total</span><span id="pay-total">‚Çπ0</span></div>
      </div>
    </div>
  </div>
</div>

<!-- ==================== THANK YOU PAGE ==================== -->
<div class="page" id="page-thankyou">
  <div class="thankyou">
    <div class="thankyou-inner">
      <div class="ty-icon">
        <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
      </div>
      <p class="ty-tag">Order Confirmed</p>
      <h1 class="ty-title">Thank You,<br><span id="ty-name">Friend</span>!</h1>
      <p class="ty-subtitle">Your order has been received and is being lovingly packed. You'll receive a confirmation email shortly with tracking details.</p>
      <div class="ty-order">
        <div class="ty-order-row"><span>Order Number</span><strong id="ty-order-num">#FORM-2025-001</strong></div>
        <div class="ty-order-row"><span>Estimated Delivery</span><strong>3‚Äì5 Business Days</strong></div>
        <div class="ty-order-row"><span>Order Total</span><strong id="ty-amount">‚Çπ0</strong></div>
        <div class="ty-order-row"><span>Payment</span><strong>Confirmed ‚úì</strong></div>
      </div>
      <div class="ty-steps">
        <div class="ty-step">
          <div class="ty-step-icon">
            <svg viewBox="0 0 24 24"><rect x="1" y="3" width="15" height="13"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>
          </div>
          <strong>Processing</strong>
          <p>Your order is being prepared for dispatch</p>
        </div>
        <div class="ty-step">
          <div class="ty-step-icon">
            <svg viewBox="0 0 24 24"><path d="M5 12h14"/><path d="M12 5l7 7-7 7"/></svg>
          </div>
          <strong>Shipped</strong>
          <p>Tracking link sent to your email</p>
        </div>
        <div class="ty-step">
          <div class="ty-step-icon">
            <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
          </div>
          <strong>Delivered</strong>
          <p>Enjoy your new FORM pieces</p>
        </div>
      </div>
      <div class="ty-btns">
        <button class="btn-primary" onclick="goTo('home')">Continue Shopping</button>
        <button class="btn-outline" style="border-color:var(--ink);color:var(--ink)">Track Order</button>
      </div>
    </div>
  </div>
  <footer style="background:var(--ink);color:rgba(255,255,255,.4);padding:24px 40px;text-align:center;font-size:12px">
    ¬© 2025 Duke. All rights reserved.
  </footer>
</div>

<!-- Toast -->
<div class="toast" id="toast">
  <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
  <span id="toast-msg">Added to cart!</span>
</div>

<!-- Scroll to top -->
<button class="scroll-top" id="scrollTop" onclick="window.scrollTo({top:0,behavior:'smooth'})">
  <svg viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"/></svg>
</button>

<script>
// ==================== ADOBE DATALAYER & ALLOY HELPERS ====================

/**
 * buildPageInfo ‚Äî returns the ACDL pageInfo object for the current view.
 * Mirrors the AEM/ACDL standard schema used by Launch rules.
 */
function buildPageInfo(pageName, pageType, category) {
  return {
    pageName:    pageName,
    pageType:    pageType,
    category:    category || '',
    siteSection: 'duke-apparel',
    language:    'en-IN',
    currency:    'INR',
    siteName:    'duke.com',
    server:      window.location.hostname || 'localhost',
    url:         window.location.href,
    referrer:    document.referrer || ''
  };
}

/**
 * buildProductObject ‚Äî maps an internal product record to the ACDL
 * product schema (compatible with Adobe Commerce / Magento ACDL).
 */
function buildProductObject(prod, qty, position) {
  return {
    productID:      prod.id,
    productName:    prod.name,
    category:       prod.category,
    price:          prod.price,
    originalPrice:  prod.origPrice || prod.price,
    currency:       'INR',
    brand:          'Duke',
    color:          prod.colors && prod.colors[0] ? prod.colors[0].name : '',
    rating:         parseFloat(prod.rating),
    reviewCount:    prod.reviews,
    quantity:       qty || 1,
    position:       position || 0,
    inStock:        true
  };
}

/**
 * buildCartObject ‚Äî full cart snapshot for checkout events.
 */
function buildCartObject() {
  const subtotal = getSubtotal();
  const gst      = Math.round(subtotal * 0.18);
  return {
    cartID:        'DUKE-CART-' + (sessionStorage.cartId || (sessionStorage.cartId = Date.now())),
    totalItems:    cart.reduce((s, i) => s + i.qty, 0),
    subtotal:      subtotal,
    tax:           gst,
    total:         subtotal + gst,
    currency:      'INR',
    products:      cart.map((item, idx) => buildProductObject(item, item.qty, idx + 1))
  };
}

/**
 * pushAdobeDataLayer ‚Äî pushes a structured event into window.adobeDataLayer
 * AND fires the corresponding alloy("sendEvent") for AEP Edge Network.
 *
 * @param {string} eventName   ‚Äî ACDL event name  e.g. "page:view"
 * @param {string} eventType   ‚Äî XDM eventType    e.g. "web.webpagedetails.pageViews"
 * @param {object} eventData   ‚Äî additional event-specific data
 * @param {object} xdmOverride ‚Äî extra XDM fields to merge
 */
function pushAdobeDataLayer(eventName, eventType, eventData, xdmOverride) {
  // ‚îÄ‚îÄ 1. Adobe Client Data Layer push ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const dlPayload = {
    event:     eventName,
    eventInfo: eventData || {},
    // Snapshot of persistent page/user state at the time of this event
    pageContext: {
      pageName:   eventData && eventData.page ? eventData.page.pageName : '',
      pageType:   eventData && eventData.page ? eventData.page.pageType : '',
    }
  };
  window.adobeDataLayer.push(dlPayload);

  // ‚îÄ‚îÄ 2. Adobe Web SDK ‚Äî alloy("sendEvent") ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  // XDM schema mirrors Adobe's ExperienceEvent mixin for retail / commerce
  const xdm = Object.assign({
    eventType: eventType,
    timestamp: new Date().toISOString(),
    web: {
      webPageDetails: {
        name:   dlPayload.pageContext.pageName,
        URL:    window.location.href,
        pageViews: { value: eventType === 'web.webpagedetails.pageViews' ? 1 : 0 }
      },
      webReferrer: { URL: document.referrer }
    },
    device: {
      screenWidth:  window.screen.width,
      screenHeight: window.screen.height,
      type: /Mobi|Android/i.test(navigator.userAgent) ? 'mobile' : 'desktop'
    }
  }, xdmOverride || {});

  alloy("sendEvent", { xdm: xdm, data: { __adobe: { duke: eventData } } });
}

// ==================== DATA ====================
const CATEGORIES = ['Shirts','T-Shirts','Pants','Shoes','Shorts','Joggers','Accessories'];
const EMOJIS = {Shirts:'üëî','T-Shirts':'üëï',Pants:'üëñ',Shoes:'üëü',Shorts:'ü©≤',Joggers:'üèÉ',Accessories:'üéí'};
const COLORS_MAP = [
  {name:'Jet Black',hex:'#1a1a1a'},
  {name:'Pure White',hex:'#f5f5f5'},
  {name:'Slate Grey',hex:'#4a5568'},
  {name:'Mocha Brown',hex:'#8B4513'},
  {name:'Forest Green',hex:'#2d5a27'},
  {name:'Rust Red',hex:'#c0392b'},
  {name:'Camel',hex:'#c8a96e'},
  {name:'Navy',hex:'#1e3a5f'},
];

const PRODUCT_NAMES = {
  Shirts: ['Oxford Classic','Linen Breeze','Chambray Essential','Poplin Slim','Flannel Weekend','Herringbone Formal','Twill Daily','Broadcloth Crisp','Dobby Luxe','Mandarin Collar'],
  'T-Shirts': ['Essential Crew','Heavyweight Tee','Slub Cotton Tee','Longline Tee','V-Neck Essential','Pocket Tee','Oversized Comfort','Half-Sleeve Modal','Ribbed Stretch','Tie-Dye Special'],
  Pants: ['Slim Chino','Cargo Utility','Linen Wide-Leg','Tapered Trouser','Relaxed Fit','Tech Jogger Pant','Pleated Classic','Drawstring Casual','Pinstripe Formal','Cropped Ankle'],
  Shoes: ['Canvas Low-Top','Leather Derby','Suede Loafer','Running Ace','Trail Hiker','Chelsea Boot','Slip-On Espadrille','High-Top Sneaker','Boat Shoe','Oxford Brogues'],
  Shorts: ['Chino Short','Athletic 5"','Linen Drawstring','Cargo Pocket','Denim Cut-Off','Swim Short','Pleated Bermuda','Running Split','Board Short','Tailored Short'],
  Joggers: ['Tech Fleece','French Terry','Tapered Slim','Wide-Leg Cozy','Zip Pocket','Lightweight Run','Ribbed Cuff','Cotton Modal','Double Knit','Travel Jogger'],
  Accessories: ['Canvas Tote','Leather Belt','Knit Beanie','Wool Scarf','Sunglasses Case','Passport Holder','Card Wallet','Watch Strap','Shoe Bag','Cap Essential'],
};

const products = {};
CATEGORIES.forEach(cat => {
  products[cat] = PRODUCT_NAMES[cat].map((name, i) => {
    const price = Math.round((599 + Math.random() * 2800) / 100) * 100;
    const hasDiscount = Math.random() > 0.5;
    const origPrice = hasDiscount ? Math.round(price * (1 + 0.1 + Math.random() * 0.3)) : null;
    const numColors = 2 + Math.floor(Math.random() * 4);
    const colors = COLORS_MAP.sort(() => Math.random() - 0.5).slice(0, numColors);
    return {
      id: `${cat.replace(/\s/g,'-')}-${i}`,
      category: cat,
      name,
      price,
      origPrice,
      colors,
      rating: (3.8 + Math.random() * 1.2).toFixed(1),
      reviews: Math.floor(40 + Math.random() * 300),
      emoji: EMOJIS[cat],
      badge: i < 2 ? (i === 0 ? 'New' : 'Bestseller') : '',
      desc: `Premium quality ${name.toLowerCase()} crafted with care. Perfect for everyday wear and special occasions alike.`,
    };
  });
});

let currentCategory = 'Shirts';
let currentProduct = null;
let cart = [];
let pdpQty = 1;

// ==================== NAVIGATION ====================
// Page-type map ‚Äî used by ACDL pageInfo
const PAGE_TYPES = {
  home:     'homepage',
  plp:      'category',
  pdp:      'product',
  cart:     'cart',
  checkout: 'checkout',
  payment:  'payment',
  thankyou: 'order-confirmation'
};

function goTo(page) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + page).classList.add('active');
  window.scrollTo(0, 0);
  if (page === 'cart')     renderCart();
  if (page === 'checkout') renderCheckoutSummary();
  if (page === 'payment')  renderPaymentSummary();

  // ‚îÄ‚îÄ ACDL + Alloy: page view ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const pageName = 'duke:' + page;
  const pageType = PAGE_TYPES[page] || page;
  const pageInfo  = buildPageInfo(pageName, pageType);

  // Push page-view event
  pushAdobeDataLayer(
    'page:view',
    'web.webpagedetails.pageViews',
    { page: pageInfo },
    {
      web: {
        webPageDetails: {
          name:      pageName,
          URL:       window.location.href,
          pageViews: { value: 1 }
        }
      },
      commerce: (page === 'cart' || page === 'checkout' || page === 'payment')
        ? { order: { currencyCode: 'INR' } }
        : undefined
    }
  );
}

function goToPLP(cat) {
  currentCategory = cat;
  document.getElementById('plp-tag').textContent = 'Collection';
  document.getElementById('plp-title').textContent = cat;
  document.getElementById('plp-count').textContent = `${products[cat].length} Products`;
  document.getElementById('plp-breadcrumb').textContent = cat;
  renderPLP(cat);
  goTo('plp');

  // ‚îÄ‚îÄ ACDL + Alloy: category / PLP view ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const productList = products[cat].map((p, idx) => buildProductObject(p, 1, idx + 1));
  pushAdobeDataLayer(
    'category:view',
    'commerce.productListViews',
    {
      page:     buildPageInfo('duke:plp:' + cat.toLowerCase(), 'category', cat),
      category: { name: cat, id: cat.toLowerCase().replace(/\s/g, '-') },
      products: productList
    },
    {
      commerce: {
        productListViews: { value: 1 },
        productListItems: productList.map(p => ({
          SKU:      p.productID,
          name:     p.productName,
          priceTotal: p.price,
          currencyCode: 'INR',
          quantity: 1
        }))
      }
    }
  );
}

function goToPDP(productId) {
  const cat = CATEGORIES.find(c => products[c].find(p => p.id === productId));
  const prod = products[cat].find(p => p.id === productId);
  if (!prod) return;
  currentProduct = prod;
  pdpQty = 1;
  document.getElementById('pdp-qty').textContent = 1;
  document.getElementById('pdp-cat-link').textContent = cat;
  document.getElementById('pdp-cat-link').onclick = () => goToPLP(cat);
  document.getElementById('pdp-name-bc').textContent = prod.name;
  document.getElementById('pdp-brand').textContent = 'Duke';
  document.getElementById('pdp-name').textContent = prod.name;
  document.getElementById('pdp-emoji').textContent = prod.emoji;
  document.getElementById('pdp-price').textContent = formatPrice(prod.price);
  const origEl = document.getElementById('pdp-price-orig');
  const discEl = document.getElementById('pdp-discount');
  if (prod.origPrice) {
    origEl.textContent = formatPrice(prod.origPrice);
    const disc = Math.round((1 - prod.price / prod.origPrice) * 100);
    discEl.textContent = `-${disc}%`;
    discEl.classList.remove('hidden');
  } else {
    origEl.textContent = '';
    discEl.classList.add('hidden');
  }
  const stars = '‚òÖ'.repeat(Math.round(prod.rating)) + '‚òÜ'.repeat(5 - Math.round(prod.rating));
  document.getElementById('pdp-stars').textContent = stars;
  document.getElementById('pdp-rating-count').textContent = `(${prod.reviews} reviews)`;
  // Colors
  const colorsEl = document.getElementById('pdp-colors');
  colorsEl.innerHTML = prod.colors.map(c =>
    `<div class="pdp-color" title="${c.name}" style="background:${c.hex}" onclick="selectColor(this)"></div>`
  ).join('');
  colorsEl.firstChild && colorsEl.firstChild.classList.add('active');
  // Thumbs
  const thumbsEl = document.getElementById('pdp-thumbs');
  thumbsEl.innerHTML = ['üëÄ','üîç','‚ú®','üì¶'].map((em,i) =>
    `<div class="pdp-thumb ${i===0?'active':''}" onclick="selectThumb(this,'${prod.emoji}')">${prod.emoji}</div>`
  ).join('');
  document.getElementById('pdp-desc').textContent = prod.desc;
  goTo('pdp');

  // ‚îÄ‚îÄ ACDL + Alloy: product detail view ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const productObj = buildProductObject(prod, 1, 1);
  pushAdobeDataLayer(
    'product:view',
    'commerce.productViews',
    {
      page:    buildPageInfo('duke:pdp:' + prod.id, 'product', cat),
      product: productObj
    },
    {
      commerce: {
        productViews: { value: 1 },
        productListItems: [{
          SKU:          prod.id,
          name:         prod.name,
          priceTotal:   prod.price,
          currencyCode: 'INR',
          quantity:     1
        }]
      }
    }
  );
}

function scrollToCats() {
  document.getElementById('categories-section').scrollIntoView({behavior:'smooth'});
}

// ==================== PLP RENDER ====================
function renderPLP(cat) {
  const grid = document.getElementById('product-grid');
  grid.innerHTML = products[cat].map(prod => `
    <div class="prod-card" onclick="goToPDP('${prod.id}')">
      <div class="prod-card-img" ${prod.badge ? `data-badge="${prod.badge}"` : ''}>
        <span style="font-size:64px">${prod.emoji}</span>
        <button class="prod-wishlist" onclick="event.stopPropagation()">
          <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
        </button>
      </div>
      <p class="prod-brand">DUKE</p>
      <p class="prod-name">${prod.name}</p>
      <div class="prod-meta">
        <span class="prod-price">${formatPrice(prod.price)}${prod.origPrice ? ` <span style="font-size:12px;color:var(--muted);text-decoration:line-through;font-weight:400">${formatPrice(prod.origPrice)}</span>` : ''}</span>
        <div class="prod-colors">${prod.colors.map(c => `<div class="prod-color-dot" style="background:${c.hex}" title="${c.name}"></div>`).join('')}</div>
      </div>
      <div class="prod-rating">
        <span class="prod-stars">${'‚òÖ'.repeat(Math.round(prod.rating))}</span>
        <span>${prod.rating} (${prod.reviews})</span>
      </div>
    </div>
  `).join('');
}

// ==================== FEATURED (HOME SWITCHER) ====================
function switchCat(cat) {
  document.querySelectorAll('.cat-tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
  currentCategory = cat;
  renderFeatured(cat);

  // ‚îÄ‚îÄ ACDL: homepage category tab switch ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  pushAdobeDataLayer(
    'ui:category-tab-click',
    'web.webinteraction.linkClicks',
    {
      page:      buildPageInfo('duke:home', 'homepage'),
      component: 'category-switcher',
      category:  cat
    },
    {
      web: { webInteraction: { name: 'category-tab:' + cat, type: 'click', linkClicks: { value: 1 } } }
    }
  );
}

function renderFeatured(cat) {
  const prods = products[cat].slice(0, 4);
  document.getElementById('featured-products').innerHTML = prods.map(prod => `
    <div class="feat-card" onclick="goToPDP('${prod.id}')">
      <div class="feat-card-img">
        <span>${prod.emoji}</span>
        <div style="position:absolute;inset:0;background:radial-gradient(circle at 50% 80%,rgba(200,169,110,.08),transparent)"></div>
      </div>
      <div class="feat-card-body">
        <p class="feat-card-cat">${cat}</p>
        <p class="feat-card-name">${prod.name}</p>
        <p class="feat-card-price">${formatPrice(prod.price)}</p>
        <div class="feat-card-colors">${prod.colors.map(c => `<div class="color-dot" style="background:${c.hex}"></div>`).join('')}</div>
      </div>
    </div>
  `).join('');
}

// ==================== CART ====================
function addToCartFromPDP() {
  if (!currentProduct) return;
  const qty = pdpQty;
  const existing = cart.find(i => i.id === currentProduct.id);
  if (existing) existing.qty += qty;
  else cart.push({...currentProduct, qty});
  updateCartBadge();
  showToast(`${currentProduct.name} added to cart!`);

  // ‚îÄ‚îÄ ACDL + Alloy: add to cart ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const productObj = buildProductObject(currentProduct, qty, 1);
  pushAdobeDataLayer(
    'cart:add',
    'commerce.productListAdds',
    {
      page:    buildPageInfo('duke:pdp:' + currentProduct.id, 'product', currentProduct.category),
      product: productObj,
      cart:    buildCartObject()
    },
    {
      commerce: {
        productListAdds: { value: 1 },
        productListItems: [{
          SKU:          currentProduct.id,
          name:         currentProduct.name,
          priceTotal:   currentProduct.price * qty,
          currencyCode: 'INR',
          quantity:     qty
        }]
      }
    }
  );
}

function addToCart(productId) {
  const cat = CATEGORIES.find(c => products[c].find(p => p.id === productId));
  const prod = products[cat].find(p => p.id === productId);
  const existing = cart.find(i => i.id === productId);
  if (existing) existing.qty++;
  else cart.push({...prod, qty: 1});
  updateCartBadge();
  showToast(`${prod.name} added to cart!`);
}

function updateCartBadge() {
  const count = cart.reduce((s, i) => s + i.qty, 0);
  document.getElementById('cart-badge').textContent = count;
}

function changeCartQty(id, delta) {
  const item = cart.find(i => i.id === id);
  if (!item) return;
  item.qty += delta;
  if (item.qty <= 0) cart = cart.filter(i => i.id !== id);
  renderCart();
  updateCartBadge();
}

function removeFromCart(id) {
  const item = cart.find(i => i.id === id);
  if (item) {
    // ‚îÄ‚îÄ ACDL + Alloy: remove from cart ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    pushAdobeDataLayer(
      'cart:remove',
      'commerce.productListRemovals',
      {
        page:    buildPageInfo('duke:cart', 'cart'),
        product: buildProductObject(item, item.qty, 1),
        cart:    buildCartObject()
      },
      {
        commerce: {
          productListRemovals: { value: 1 },
          productListItems: [{ SKU: item.id, name: item.name, quantity: item.qty }]
        }
      }
    );
  }
  cart = cart.filter(i => i.id !== id);
  renderCart();
  updateCartBadge();
}

function getSubtotal() { return cart.reduce((s, i) => s + i.price * i.qty, 0); }

function renderCart() {
  const layout = document.getElementById('cart-layout');
  if (cart.length === 0) {
    layout.innerHTML = `<div class="cart-empty">
      <div class="cart-empty-icon">üõí</div>
      <h2>Your cart is empty</h2>
      <p>Looks like you haven't added anything yet.</p>
      <button class="btn-primary" onclick="goTo('home')">Start Shopping</button>
    </div>`;
    return;
  }
  const subtotal = getSubtotal();
  const gst = Math.round(subtotal * 0.18);
  const total = subtotal + gst;
  layout.innerHTML = `
    <div>
      ${cart.map(item => `
        <div class="cart-item">
          <div class="cart-item-img">${item.emoji}</div>
          <div>
            <p class="cart-item-name">${item.name}</p>
            <p class="cart-item-meta">Size: M ¬∑ Color: ${item.colors[0]?.name || 'Black'} ¬∑ Duke</p>
            <div class="cart-item-qty">
              <button onclick="changeCartQty('${item.id}',-1)">‚àí</button>
              <span>${item.qty}</span>
              <button onclick="changeCartQty('${item.id}',1)">+</button>
            </div>
          </div>
          <div>
            <p class="cart-item-price">${formatPrice(item.price * item.qty)}</p>
            <span class="cart-item-remove" onclick="removeFromCart('${item.id}')">Remove</span>
          </div>
        </div>
      `).join('')}
    </div>
    <div class="cart-summary">
      <h3>Order Summary</h3>
      <div class="summary-row"><span>Subtotal (${cart.reduce((s,i)=>s+i.qty,0)} items)</span><span>${formatPrice(subtotal)}</span></div>
      <div class="summary-row"><span>Shipping</span><span>${subtotal >= 999 ? 'Free' : '‚Çπ99'}</span></div>
      <div class="summary-row"><span>GST (18%)</span><span>${formatPrice(gst)}</span></div>
      <div class="summary-row total"><span>Total</span><span>${formatPrice(total)}</span></div>
      <div class="promo-code">
        <input type="text" placeholder="Promo code">
        <button>Apply</button>
      </div>
      <button class="checkout-btn gold" onclick="goTo('checkout')">Proceed to Checkout ‚Üí</button>
      <button class="checkout-btn" style="background:transparent;border:1.5px solid var(--border);color:var(--ink)" onclick="goTo('home')">Continue Shopping</button>
    </div>`;
}

function renderCheckoutSummary() {
  const el = document.getElementById('checkout-items');
  const subtotal = getSubtotal();
  const gst = Math.round(subtotal * 0.18);
  el.innerHTML = cart.map(item => `
    <div class="order-item-row">
      <div class="order-item-img">${item.emoji}<span class="order-item-badge">${item.qty}</span></div>
      <div><p class="order-item-name">${item.name}</p><p class="order-item-meta">Size M ¬∑ ${item.colors[0]?.name||'Black'}</p></div>
      <span class="order-item-price">${formatPrice(item.price*item.qty)}</span>
    </div>`).join('');
  document.getElementById('co-subtotal').textContent = formatPrice(subtotal);
  document.getElementById('co-gst').textContent = formatPrice(gst);
  document.getElementById('co-total').textContent = formatPrice(subtotal + gst);
}

function renderPaymentSummary() {
  const el = document.getElementById('payment-items');
  const subtotal = getSubtotal();
  const gst = Math.round(subtotal * 0.18);
  el.innerHTML = cart.map(item => `
    <div class="order-item-row">
      <div class="order-item-img">${item.emoji}<span class="order-item-badge">${item.qty}</span></div>
      <div><p class="order-item-name">${item.name}</p><p class="order-item-meta">Size M</p></div>
      <span class="order-item-price">${formatPrice(item.price*item.qty)}</span>
    </div>`).join('');
  document.getElementById('pay-subtotal').textContent = formatPrice(subtotal);
  document.getElementById('pay-gst').textContent = formatPrice(gst);
  document.getElementById('pay-total').textContent = formatPrice(subtotal + gst);
}

function placeOrder() {
  const subtotal = getSubtotal();
  const gst   = Math.round(subtotal * 0.18);
  const total  = subtotal + gst;
  const name   = document.getElementById('fname')?.value || 'Friend';
  const orderNum = 'DUKE-2025-' + Math.floor(1000 + Math.random() * 9000);

  document.getElementById('ty-name').textContent      = name || 'Friend';
  document.getElementById('ty-amount').textContent    = formatPrice(total);
  document.getElementById('ty-order-num').textContent = '#' + orderNum;

  // ‚îÄ‚îÄ ACDL + Alloy: purchase / order placed ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const cartSnapshot = buildCartObject();
  pushAdobeDataLayer(
    'order:placed',
    'commerce.purchases',
    {
      page:    buildPageInfo('duke:thankyou', 'order-confirmation'),
      order: {
        orderID:      orderNum,
        subtotal:     subtotal,
        tax:          gst,
        total:        total,
        currency:     'INR',
        customerName: name,
        products:     cartSnapshot.products
      },
      cart: cartSnapshot
    },
    {
      commerce: {
        purchases: { value: 1 },
        order: {
          purchaseID:   orderNum,
          priceTotal:   total,
          taxAmount:    gst,
          currencyCode: 'INR'
        },
        productListItems: cart.map(item => ({
          SKU:          item.id,
          name:         item.name,
          priceTotal:   item.price * item.qty,
          currencyCode: 'INR',
          quantity:     item.qty
        }))
      }
    }
  );

  cart = [];
  updateCartBadge();
  goTo('thankyou');
}

// ==================== UI HELPERS ====================
function formatPrice(n) { return '‚Çπ' + n.toLocaleString('en-IN'); }

function showToast(msg) {
  const t = document.getElementById('toast');
  document.getElementById('toast-msg').textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3000);
}

function changeQty(delta) {
  pdpQty = Math.max(1, pdpQty + delta);
  document.getElementById('pdp-qty').textContent = pdpQty;
}

function selectSize(btn) {
  if (btn.classList.contains('unavail')) return;
  btn.closest('.pdp-info, .filter-panel')?.querySelectorAll('.pdp-size').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

function selectColor(dot) {
  dot.closest('.pdp-colors').querySelectorAll('.pdp-color').forEach(d => d.classList.remove('active'));
  dot.classList.add('active');
}

function selectThumb(thumb, emoji) {
  document.querySelectorAll('.pdp-thumb').forEach(t => t.classList.remove('active'));
  thumb.classList.add('active');
  document.getElementById('pdp-emoji').textContent = emoji;
}

function toggleAccordion(header) {
  const acc = header.closest('.accordion');
  acc.classList.toggle('open');
}

function toggleFilter(header) {
  const opts = header.nextElementSibling;
  const chevron = header.querySelector('.filter-chevron');
  if (opts.style.display === 'none') {
    opts.style.display = '';
    chevron.classList.add('open');
  } else {
    opts.style.display = 'none';
    chevron.classList.remove('open');
  }
}

function toggleFilterOpt(label) {
  label.classList.toggle('active');
}

function toggleColorFilter(dot) {
  dot.classList.toggle('active');
}

function sortProducts(val) {
  const cat = currentCategory;
  let sorted = [...products[cat]];
  if (val === 'price-asc') sorted.sort((a,b) => a.price - b.price);
  else if (val === 'price-desc') sorted.sort((a,b) => b.price - a.price);
  else if (val === 'rating') sorted.sort((a,b) => b.rating - a.rating);
  else if (val === 'newest') sorted.reverse();
  const orig = products[cat];
  products[cat] = sorted;
  renderPLP(cat);
  products[cat] = orig;

  // ‚îÄ‚îÄ ACDL: PLP sort interaction ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  pushAdobeDataLayer(
    'plp:sort',
    'web.webinteraction.linkClicks',
    {
      page:      buildPageInfo('duke:plp:' + cat.toLowerCase(), 'category', cat),
      component: 'sort-selector',
      sortBy:    val,
      category:  cat
    },
    {
      web: { webInteraction: { name: 'plp-sort:' + val, type: 'other', linkClicks: { value: 1 } } }
    }
  );
}

function selectDelivery(label) {
  document.querySelectorAll('.delivery-opt').forEach(o => o.classList.remove('active'));
  label.classList.add('active');
  const method = label.querySelector('.delivery-opt-name')?.textContent || '';

  // ‚îÄ‚îÄ ACDL: delivery method selection ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  pushAdobeDataLayer(
    'checkout:delivery-method-select',
    'web.webinteraction.linkClicks',
    {
      page:           buildPageInfo('duke:checkout', 'checkout'),
      component:      'delivery-selector',
      deliveryMethod: method,
      cart:           buildCartObject()
    },
    {
      web: { webInteraction: { name: 'delivery:' + method, type: 'click', linkClicks: { value: 1 } } }
    }
  );
}

function selectPayMethod(btn, method) {
  document.querySelectorAll('.pay-method').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  ['card','upi','netbank','cod'].forEach(m => {
    const el = document.getElementById('pay-'+m+'-form');
    if(el) el.classList.toggle('hidden', m !== method);
  });

  // ‚îÄ‚îÄ ACDL: payment method selection ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  pushAdobeDataLayer(
    'checkout:payment-method-select',
    'web.webinteraction.linkClicks',
    {
      page:          buildPageInfo('duke:payment', 'payment'),
      component:     'payment-method-selector',
      paymentMethod: method,
      cart:          buildCartObject()
    },
    {
      web: { webInteraction: { name: 'payment:' + method, type: 'click', linkClicks: { value: 1 } } }
    }
  );
}

function updateCardPreview(input, field) {
  if (field === 'number') {
    let v = input.value.replace(/\D/g,'').substring(0,16);
    input.value = v.replace(/(.{4})/g,'$1 ').trim();
    document.getElementById('preview-number').textContent = (input.value || '‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢').padEnd(19,'‚Ä¢').replace(/\d(?=.{1,4} )/g,'‚Ä¢');
  } else if (field === 'name') {
    document.getElementById('preview-name').textContent = input.value.toUpperCase() || 'YOUR NAME';
  } else if (field === 'expiry') {
    document.getElementById('preview-expiry').textContent = input.value || 'MM/YY';
  }
}

// Scroll to top visibility
window.addEventListener('scroll', () => {
  const btn = document.getElementById('scrollTop');
  btn.classList.toggle('visible', window.scrollY > 400);
});

// ==================== ACDL CHECKOUT STEP HELPERS ====================
// Called from inline onclick on checkout "Continue" button
function fireCheckoutStep(step, stepName) {
  pushAdobeDataLayer(
    'checkout:step',
    'commerce.checkouts',
    {
      page:     buildPageInfo('duke:checkout', 'checkout'),
      step:     step,
      stepName: stepName,
      cart:     buildCartObject()
    },
    {
      commerce: {
        checkouts: { value: 1 },
        order: {
          currencyCode: 'INR',
          priceTotal:   getSubtotal() + Math.round(getSubtotal() * 0.18)
        }
      }
    }
  );
}

// ==================== ACDL DEBUG PANEL ====================
// Floating console so you can see all data layer pushes without DevTools
(function() {
  const panel = document.createElement('div');
  panel.id = 'acdl-debug';
  panel.style.cssText = [
    'position:fixed','bottom:80px','right:16px','width:340px','max-height:420px',
    'background:#0d0d0d','border:1px solid #333','border-radius:6px',
    'font-family:monospace','font-size:11px','color:#e0e0e0',
    'z-index:9999','overflow:hidden','display:flex','flex-direction:column',
    'box-shadow:0 8px 32px rgba(0,0,0,.5)'
  ].join(';');

  panel.innerHTML = `
    <div style="background:#1a1a1a;padding:10px 14px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #333;gap:8px">
      <span style="color:#eb1000;font-weight:700;letter-spacing:.05em">‚óâ ACDL / Alloy Debug</span>
      <div style="display:flex;gap:8px">
        <span id="acdl-count" style="background:#eb1000;color:#fff;border-radius:10px;padding:1px 7px;font-size:10px">0</span>
        <button onclick="document.getElementById('acdl-debug').style.display='none'"
          style="background:none;border:none;color:#888;font-size:16px;cursor:pointer;line-height:1">√ó</button>
      </div>
    </div>
    <div id="acdl-log" style="overflow-y:auto;flex:1;padding:8px 0"></div>
    <div style="background:#1a1a1a;padding:6px 10px;border-top:1px solid #333;display:flex;gap:8px">
      <button onclick="document.getElementById('acdl-log').innerHTML='';acdlEventCount=0;document.getElementById('acdl-count').textContent='0'"
        style="background:#333;border:none;color:#aaa;font-size:10px;padding:4px 8px;border-radius:3px;cursor:pointer">Clear</button>
      <span style="color:#555;font-size:10px;align-self:center">Open DevTools console for full payloads</span>
    </div>`;

  document.body.appendChild(panel);

  let acdlEventCount = 0;

  // Intercept future ACDL pushes for the panel
  const origPush = window.adobeDataLayer.push.bind(window.adobeDataLayer);
  window.adobeDataLayer.push = function(payload) {
    origPush(payload);
    acdlEventCount++;
    document.getElementById('acdl-count').textContent = acdlEventCount;
    const log = document.getElementById('acdl-log');
    const entry = document.createElement('div');
    entry.style.cssText = 'padding:6px 12px;border-bottom:1px solid #1a1a1a;cursor:pointer;transition:background .15s';
    entry.onmouseenter = () => entry.style.background = '#1c1c1c';
    entry.onmouseleave = () => entry.style.background = '';

    const time = new Date().toLocaleTimeString();
    const eventName = payload.event || payload['@type'] || 'state';
    const color = payload.event && payload.event.startsWith('order') ? '#27ae60'
                : payload.event && payload.event.startsWith('cart')  ? '#c8a96e'
                : payload.event && payload.event.startsWith('product')? '#74b9ff'
                : payload.event && payload.event.startsWith('page')   ? '#a29bfe'
                : '#dfe6e9';

    entry.innerHTML = `<span style="color:#555">${time}</span> <span style="color:${color};font-weight:700">${eventName}</span>`;
    entry.title = JSON.stringify(payload, null, 2);
    log.insertBefore(entry, log.firstChild);
  };
})();

// Init
renderFeatured('Shirts');
goTo('home');
</script>
</body>
</html>
